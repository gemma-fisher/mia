---
layout: default
---

<head>
    <link rel="stylesheet" href="../../css/index.css">
</head>

<body>
<!-- Side navigation -->
<div class="sidenav">
    <a href="../../index.html" class="nav1">Introduction</a>
    <a href="../gettingstarted.html" class="nav1">Getting started</a>
    <a href="../modulelist.html" class="nav1">Modules</a>
    <a href="../macrolist.html" class="nav1">Macros</a>
    <!-- <a href="../extendingmia.html" class="nav1">Extending MIA</a> -->
</div>

<!-- Page content -->
<div class="main">
    <!--The following is replaced automatically by the generated module list-->
    <a href="../modulelist.html">Back to module list</a>
<h1>Run macro on objects</h1>
<h2>Description</h2>
Run a specific ImageJ macro once per object from a specified input object collection (as opposed to the "Run macro" module, which runs once per analysis run).  This module can optionally open an image into ImageJ for the macro to run on.  Variables assigned during the macro can be extracted and stored as measurements associated with the current object.<br><br>Note: ImageJ can only run one macro at a time, so by using this module the "Simultaneous jobs" parameter of the "Input control" module must be set to 1.<br><br>Note: When this module runs, all windows currently open in ImageJ will be automatically hidden, then re-opened upon macro completion.  This is to prevent accidental interference while the macro is running.  It also allows the macro to run much faster (batch mode).  To keep images open while the macro is running (for example, during debugging) start the macro with the command "setBatchMode(false)".
<h2>Parameters</h2>
<ul><li><b>Add variable</b> (default = "") Pre-define variables, which will be immediately accessible within the macro.  These can be used to provide user-controllable values to file-based macros or to prevent the need for editing macro code via the "Run macro on objects" panel.</li><br><li><b>Variable type</b> (default = "Text") Controls the data type of the variable that will be assigned within the macro:<br><ul>"Boolean" Variable will be assigned a true/false value depending on whether the checkbox was selected/deselected (respectively).</li>."Number" Variable will be assigned a numeric value to which mathematical operations can be applied.</li>."Text" Variable will be assigned a text value.  Irrespective of whether the value contains only numeric characters this will be interpreted as text.</li></ul>.</li><br><li><b>Variable name</b> (default = "") The variable value can be accessed from within the macro by using this variable name.</li><br><li><b>Variable checkbox</b> (default = "true") Boolean (true/false) value assigned to this variable if "Variable type" is set to "Boolean".</li><br><li><b>Variable numeric value</b> (default = "0.0") Numeric value assigned to this variable if "Variable type" is set to "Number".</li><br><li><b>Variable text value</b> (default = "") Text value assigned to this variable if "Variable type" is set to "Text".</li><br><li><b>Input objects</b> (default = "") The specified macro will be run once on each of the objects from this object collection.  No information (e.g. assigned variables) is transferred between macro runs.</li><br><li><b>Provide input image</b> (default = "true") When selected, a specified image from the workspace will be opened prior to running the macro.  This image will be the "active" image the macro runs on.</li><br><li><b>Input image</b> (default = "") If "Provide input image" is selected, this is the image that will be loaded into the macro.  A duplicate of this image is made, so the image stored in the workspace will not be affected by any processing in the macro.</li><br><li><b>Update image after each run</b> (default = "false") When selected (and "Provide input image" is also selected), the input image will be updated to the currently-active image at the end of each iteration.  This allows all object runs for a macro to alter the input image..</li><br><li><b>Macro mode</b> (default = "Macro text") Select the source for the macro code:<br><ul><li>"Macro file" Load the macro from the file specified by the "Macro file" parameter.</li><li>"Macro text" Macro code is written directly into the "Macro text" box.</li></ul></li><br><li><b>Macro text</b> (default = "// Variables have been pre-defined for the input object name ("objectName"), its ID number ("ID") and the macro iteration count ("count").

run("Enable MIA Extensions");

") Macro code to be executed.  MIA macro commands are enabled using the "run("Enable MIA Extensions");" command which is included by default.  This should always be the first line of a macro if these commands are needed.</li><br><li><b>Macro file</b> (default = "") Select a macro file (.ijm) to be run by this module.  As with the "Macro text" parameter, this macro should start with the "run("Enable MIA Extensions");" command.</li><br><li><b>Intercept variable as measurement</b> (default = "") This allows variables assigned in the macro to be stored as measurements associated with the current object.</li><br><li><b>Variable</b> (default = "") Variable assigned in the macro to be stored as a measurement associated with the current object.  This name must exactly match (including case) the name as written in the macro.</li><br></ul>

</div>
</body>