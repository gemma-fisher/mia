---
layout: default
---

<head>
    <link rel="stylesheet" href="../../css/index.css">
</head>

<body>
<!-- Side navigation -->
<div class="sidenav">
    <a href="../../index.html" class="nav1">Introduction</a>
    <a href="../gettingstarted.html" class="nav1">Getting started</a>
    <a href="../modulelist.html" class="nav1">Modules</a>
    <a href="../macrolist.html" class="nav1">Macros</a>
    <!-- <a href="../extendingmia.html" class="nav1">Extending MIA</a> -->
</div>

<!-- Page content -->
<div class="main">
    <!--The following is replaced automatically by the generated module list-->
    <a href="../modulelist.html">Back to module list</a>
<h1>Calculate nearest neighbour</h1>
<h2>Description</h2>
Measures the shortest distance between all objects in the specified input collection and all other objects in the same, or a different collection.  The shortest distance (nearest neighbour distance) is recorded as a measurement associated with the input object.  Optionally, the distances between all objects can be calculated and exported as a standalone spreadsheet.
<h2>Parameters</h2>
<ul><li><b>Input objects</b> (default = "") Objects for which the distance to a closest neighbour will be calculated.  The closest distance will be stored as a measurement associated with this object.</li><br><li><b>Relationship mode</b> (default = "Within same object set") Controls whether the nearest neighbour distance from each input object will be calculated relative to all other objects in that input collection ("Within same object set") or to all objects in another object collection ("Different object set").</li><br><li><b>Neighbour objects</b> (default = "") If "Relationship mode" is set to "Different object set", the distance from the input objects to these objects will be calculated and the shortest distance recorded.</li><br><li><b>Reference mode</b> (default = "Centroid (3D)") Controls the method used for determining the nearest neighbour distances:<br><ul><li>"Centroid (2D)" Distances are between the input and neighbour object centroids, but only in the XY plane.  These distances are always positive; increasing as the distance between centroids increases.</li><li>"Centroid (3D)" Distances are between the input and neighbour object centroids.  These distances are always positive; increasing as the distance between centroids increases.</li><li>"Surface (2D)" Distances are between the closest points on the input and neighbour surfaces, but only in the XY plane.  These distances increase in magnitude the greater the minimum input-neighbour object surface distance is; however, they are assigned a positive value if the closest input object surface point is outside the neighbour and a negative value if the closest input object surface point is inside the neighbour.  For example, a closest input object surface point 5px outside the neighbour will be simply "5px", whereas a closest input object surface point 5px from the surface, but contained within the neighbour object will be recorded as "-5px".  Note: Any instances where the input and neighbour object surfaces overlap will be recorded as "0px" distance.</li><li>"Surface (3D)" Distances are between the closest points on the input and neighbour surfaces.  These distances increase in magnitude the greater the minimum input-neighbour object surface distance is; however, they are assigned a positive value if the closest input object surface point is outside the neighbour and a negative value if the closest input object surface point is inside the neighbour.  For example, a closest input object surface point 5px outside the neighbour will be simply "5px", whereas a closest input object surface point 5px from the surface, but contained within the neighbour object will be recorded as "-5px".  Note: Any instances where the input and neighbour object surfaces overlap will be recorded as "0px" distance.</li></ul></li><br><li><b>Only calculate for objects in same parent</b> (default = "false") When selected, only distances between objects within the same parent (specified by "Parent objects") will be considered.</li><br><li><b>Parent objects</b> (default = "") When "Only calculate for objects in same parent" is selected, objects must have this same parent to have their nearest neighbour distances calculated.</li><br><li><b>Limit linking distance</b> (default = "false") When selected, nearest neighbour distances will only be calculated if that distance (as calculated by the "Reference mode" metric) is less than or equal to the distance defined by "Maximum linking distance".</li><br><li><b>Maximum linking distance</b> (default = "100.0") If "Limit linking distance" is selected, this is the maximum permitted distance between objects for them to have their nearest neighbour distance recorded.</li><br><li><b>Calibrated distance</b> (default = "false") When selected, linking distances are to be specified in calibrated units; otherwise, units are specified in pixels.</li><br><li><b>Only link objects in same frame</b> (default = "false") When selected, objects must be in the same time frame for them to be linked.</li><br><li><b>Export all distances</b> (default = "false") For each analysis run, create a separate spreadsheet file, which records the distance of all objects to all other objects.</li><br><li><b>Inside/outside mode</b> (default = "Inside and outside (all distances)") When relating objects by surfaces it's possible to only consider objects inside, outside or on the edge of the neighbouring object.  This parameter controls which objects are allowed to be related to a neighbour.  Choices are: Inside and outside (all distances), Inside only (distances < 0), Inside and on surface (distances <= 0), On surface only (distances = 0), Outside and on surface (distances >= 0), Outside only (distances > 0).</li><br><li><b>Include timepoints</b> (default = "false") Include a column recording the timepoint that the objects were present in.  If only linking objects in the same frame, there will be a single timepoint column; however, if links are permitted between objects in different timepoints, a timepoint colummn for each of the related objects will be included.</li><br><li><b>Include input object parent</b> (default = "false") Include a column recording the ID number of a specific parent of the input object.  For example, this could be a track ID number.</li><br><li><b>Input object parent</b> (default = "") Parent object collection of the input object.  If "Include input object parent" is selected, the corresponding parent ID number will be included as a column in the output distances spreadsheet.</li><br><li><b>Include neighbour object parent</b> (default = "false") Include a column recording the ID number of a specific parent of the neighbour object.  For example, this could be a track ID number.</li><br><li><b>Neighbour object parent</b> (default = "") Parent object collection of the neighbour object.  If "Include neighbour object parent" is selected, the corresponding parent ID number will be included as a column in the output distances spreadsheet.</li><br><li><b>Save name mode</b> (default = "Match input file name") Controls how saved distance file names will be generated.<br><ul><li>"Match input file name" Use the same name as the root file for this workspace (i.e. the input file in "Input control".</li><li>"Specific name" Use a specific name for the output file.  Care should be taken with this when working in batch mode as it's easy to continuously write over output files from other runs.</li></ul></li><br><li><b>File name</b> (default = "") Filename for saved distance file.  Note: Care should be taken with this when working in batch mode as it's easy to continuously write over output files from other runs.</li><br><li><b>Append series mode</b> (default = "Series number") Controls if any series information should be appended to the end of the filename.  This is useful when working with multi-series files, as it should help prevent writing files from multiple runs with the same filename.  Series numbers are prepended by "S".  Choices are: None, Series name, Series number.</li><br><li><b>Append date/time mode</b> (default = "Never") Controls under what conditions the time and date will be appended on to the end of the distance file filename.  This can be used to prevent accidental over-writing of files from previous runs:<br><ul><li>"Always" Always append the time and date on to the end of the filename.</li><li>"If file exists" Only append the time and date if the results file already exists.</li><li>"Never" Never append time and date (unless the file is open and unwritable).</li></ul></li><br><li><b>Add filename suffix</b> (default = "") A custom suffix to be added to each filename.</li><br></ul>

</div>
</body>